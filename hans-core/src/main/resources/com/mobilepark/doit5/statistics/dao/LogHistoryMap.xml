<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="logHistory">

	<!-- 로그인 이력 -->
	<select id="getHistCustCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_CUST, TB_CUST_MEMBER
		<where>
			<if test="_parameter.containsKey('logTypes') and logTypes != null and _parameter.get('logTypes').length > 0">
			    AND LOG_TYPE IN
			    <foreach item="item" index="index" collection="logTypes" open="(" separator="," close=")">
			        #{item}
			    </foreach>
			</if>
			<if test="_parameter.containsKey('accessDevice') and accessDevice != null and _parameter.get('accessDevice').length > 0">
			    AND ACCESS_DEVICE IN
			    <foreach item="item" index="index" collection="accessDevice" open="(" separator="," close=")">
			        #{item}
			    </foreach>
			</if>
			AND TB_HIST_CUST.USID = TB_CUST_MEMBER.USID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_CUST.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_CUST.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="usid != null and usid != ''"> 
				AND TB_HIST_CUST.USID = #{usid}
			</if>
		</where>
	</select>

	<!-- 로그인 이력 -->
	<select id="getHistCustList" parameterType="map" resultType="map">
		SELECT
			SN_ID, TB_HIST_CUST.FST_RG_DT,
			ACCESS_DEVICE, LOG_TYPE, RESULT_CODE, CERT_CARD_NO, CHARGER_ID, ADD_INFO,
			TB_HIST_CUST.USID, TB_CUST_MEMBER.SUBS_ID, TB_CUST_MEMBER.NAME
		FROM
			TB_HIST_CUST, TB_CUST_MEMBER
		<where>
			<if test="_parameter.containsKey('logTypes') and logTypes != null and _parameter.get('logTypes').length > 0">
			    AND LOG_TYPE IN
			    <foreach item="item" index="index" collection="logTypes" open="(" separator="," close=")">
			        #{item}
			    </foreach>
			</if>
			<if test="_parameter.containsKey('accessDevice') and accessDevice != null and _parameter.get('accessDevice').length > 0">
			    AND ACCESS_DEVICE IN
			    <foreach item="item" index="index" collection="accessDevice" open="(" separator="," close=")">
			        #{item}
			    </foreach>
			</if>
			AND TB_HIST_CUST.USID = TB_CUST_MEMBER.USID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_CUST.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_CUST.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="usid != null and usid != ''"> 
				AND TB_HIST_CUST.USID = #{usid}
			</if>
		</where>
		ORDER BY TB_HIST_CUST.SN_ID DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>
	
	<!-- PUSH 발신 이력 -->
	<select id="getPushMsgCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_PUSH_MSG, TB_CUST_MEMBER
		<where>
			TB_HIST_PUSH_MSG.USID = TB_CUST_MEMBER.USID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_PUSH_MSG.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_PUSH_MSG.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND TB_HIST_PUSH_MSG.USID = #{usid}
			</if>
		</where>
	</select>

	<!-- PUSH 발신 이력 -->
	<select id="getPushMsgList" parameterType="map" resultType="map">
		SELECT
			SN_ID, TB_HIST_PUSH_MSG.FST_RG_DT,
			CUST_TYPE, CUST_NAME, TB_HIST_PUSH_MSG.OS, MOBILE, CATEGORY, TITLE, MSG, RESULT_CODE,
			TB_HIST_PUSH_MSG.USID, TB_CUST_MEMBER.SUBS_ID, TB_CUST_MEMBER.NAME
		FROM
			TB_HIST_PUSH_MSG, TB_CUST_MEMBER
		<where>
			TB_HIST_PUSH_MSG.USID = TB_CUST_MEMBER.USID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_PUSH_MSG.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_PUSH_MSG.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND TB_HIST_PUSH_MSG.USID = #{usid}
			</if>
		</where>
		ORDER BY TB_HIST_PUSH_MSG.SN_ID DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>
	
	<!-- 충전기 이력 - 개통 / 재설치 이력 -->
	<select id="getStationApplicationCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_ELCG_STATION_APPLICATION, TB_ELCG_BD_GROUP, TB_ELCG_BD, TB_ELCG_CHARGER, TB_ELCG_CHARGER_GROUP, TB_MGMT_ADMIN
		<where>
			TB_ELCG_STATION_APPLICATION.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID
			AND TB_ELCG_STATION_APPLICATION.BD_ID = TB_ELCG_BD.BD_ID
			AND TB_ELCG_BD.BD_ID = TB_ELCG_CHARGER_GROUP.BD_ID 
			AND TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID = TB_ELCG_CHARGER.CHARGER_GROUP_ID
			AND TB_ELCG_STATION_APPLICATION.WK_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="mgmtNo != null and mgmtNo != ''"> 
	 			AND TB_ELCG_CHARGER.MGMT_NO LIKE CONCAT('%', #{mgmtNo}, '%')
	  		</if>
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_ELCG_STATION_APPLICATION.WK_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_ELCG_STATION_APPLICATION.WK_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
		</where>
	</select>

	<!-- 충전기 이력 - 개통 / 재설치 이력 -->
	<select id="getStationApplicationList" parameterType="map" resultType="map">
		SELECT
			TB_ELCG_STATION_APPLICATION.SN_ID,
			TB_ELCG_STATION_APPLICATION.WK_DT,
			TB_ELCG_CHARGER.MGMT_NO,
			TB_ELCG_STATION_APPLICATION.BD_GROUP_ID,
			TB_ELCG_BD_GROUP.NAME AS BD_GROUP_NAME,
			TB_ELCG_STATION_APPLICATION.BD_ID,
			TB_ELCG_BD.NAME AS BD_NAME,
			TB_ELCG_CHARGER_GROUP.NAME AS CHARGER_GROUP_NAME,
			TB_ELCG_STATION_APPLICATION.WK_USID,
			TB_MGMT_ADMIN.NAME AS ADMIN_NAME
		FROM
			TB_ELCG_STATION_APPLICATION, TB_ELCG_BD_GROUP, TB_ELCG_BD, TB_ELCG_CHARGER, TB_ELCG_CHARGER_GROUP, TB_MGMT_ADMIN
		<where>
			TB_ELCG_STATION_APPLICATION.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID
			AND TB_ELCG_STATION_APPLICATION.BD_ID = TB_ELCG_BD.BD_ID
			AND TB_ELCG_BD.BD_ID = TB_ELCG_CHARGER_GROUP.BD_ID 
			AND TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID = TB_ELCG_CHARGER.CHARGER_GROUP_ID
			AND TB_ELCG_STATION_APPLICATION.WK_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="mgmtNo != null and mgmtNo != ''"> 
	 			AND TB_ELCG_CHARGER.MGMT_NO LIKE CONCAT('%', #{mgmtNo}, '%')
	  		</if>
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_ELCG_STATION_APPLICATION.WK_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_ELCG_STATION_APPLICATION.WK_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
		</where>
		ORDER BY TB_ELCG_STATION_APPLICATION.SN_ID DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>

	<!-- 충전기 이력 - 고장 / 탈거 이력 -->
	<select id="getBrokenReportCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_ELCG_BROKEN_REPORT, TB_ELCG_BD_GROUP, TB_ELCG_BD, TB_ELCG_CHARGER_GROUP, TB_ELCG_CHARGER, TB_MGMT_ADMIN
		<where>
			TB_ELCG_BROKEN_REPORT.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID
			AND TB_ELCG_BROKEN_REPORT.BD_ID = TB_ELCG_BD.BD_ID
			AND TB_ELCG_BROKEN_REPORT.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			AND TB_ELCG_CHARGER.CHARGER_GROUP_ID = TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID
			AND TB_ELCG_BROKEN_REPORT.WK_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_ELCG_BROKEN_REPORT.WK_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_ELCG_BROKEN_REPORT.WK_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="mgmtNo != null and mgmtNo != ''"> 
	 			AND TB_ELCG_CHARGER.MGMT_NO LIKE CONCAT('%', #{mgmtNo}, '%')
	  		</if>
		</where>
	</select>

	<!-- 충전기 이력 - 고장 / 탈거 이력 -->
	<select id="getBrokenReportList" parameterType="map" resultType="map">
		SELECT
			TB_ELCG_BROKEN_REPORT.SN_ID,
			TB_ELCG_BROKEN_REPORT.WK_DT,
			TB_ELCG_CHARGER.MGMT_NO,
			TB_ELCG_BROKEN_REPORT.BD_GROUP_ID,
			TB_ELCG_BD_GROUP.NAME AS BD_GROUP_NAME,
			TB_ELCG_BROKEN_REPORT.BD_ID,
			TB_ELCG_BD.NAME AS BD_NAME,
			TB_ELCG_CHARGER_GROUP.NAME AS CHARGER_GROUP_NAME,
			TB_ELCG_BROKEN_REPORT.WK_USID,
			TB_MGMT_ADMIN.NAME AS ADMIN_NAME
		FROM
			TB_ELCG_BROKEN_REPORT, TB_ELCG_BD_GROUP, TB_ELCG_BD, TB_ELCG_CHARGER_GROUP, TB_ELCG_CHARGER, TB_MGMT_ADMIN
		<where>
			TB_ELCG_BROKEN_REPORT.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID
			AND TB_ELCG_BROKEN_REPORT.BD_ID = TB_ELCG_BD.BD_ID
			AND TB_ELCG_BROKEN_REPORT.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			AND TB_ELCG_CHARGER.CHARGER_GROUP_ID = TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID
			AND TB_ELCG_BROKEN_REPORT.WK_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_ELCG_BROKEN_REPORT.WK_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_ELCG_BROKEN_REPORT.WK_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="mgmtNo != null and mgmtNo != ''"> 
	 			AND TB_ELCG_CHARGER.MGMT_NO LIKE CONCAT('%', #{mgmtNo}, '%')
	  		</if>
		</where>
		ORDER BY TB_ELCG_BROKEN_REPORT.SN_ID DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>

	<!-- 설치자 이력 - 신청/신고 이력 -->
	<select id="getInstallerCount" parameterType="map" resultType="int">
		SELECT SUM(CNT) AS CNT
			FROM
			(
		SELECT
			COUNT(*) AS CNT
		FROM TB_ELCG_STATION_APPLICATION, TB_ELCG_BD, TB_ELCG_BD_GROUP, TB_MGMT_ADMIN
		<where>
			1=1
			<if test="wkUsid != null and wkUsid != ''"> 
			AND TB_ELCG_STATION_APPLICATION.WK_USID = #{wkUsid}
			</if>
			<if test="wkName != null and wkName != ''"> 
			AND TB_MGMT_ADMIN.NAME LIKE CONCAT('%', #{wkName}, '%')
			</if>
			AND TB_ELCG_STATION_APPLICATION.BD_ID = TB_ELCG_BD.BD_ID 
			AND TB_ELCG_STATION_APPLICATION.BD_GROUP_ID = TB_ELCG_BD.BD_GROUP_ID 
			AND TB_ELCG_BD.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID 
			AND TB_ELCG_STATION_APPLICATION.WK_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and fromDate != ''"> 
	 		AND DATE_FORMAT(TB_ELCG_STATION_APPLICATION.RC_DT, '%Y%m%d') &gt;= #{fromDate}
	  		</if>
			<if test="toDate != null and toDate != ''"> 
	  		AND DATE_FORMAT(TB_ELCG_STATION_APPLICATION.RC_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
		</where>
		UNION
		SELECT
			COUNT(*) AS CNT
		FROM TB_ELCG_BROKEN_REPORT
			LEFT JOIN TB_ELCG_CHARGER ON TB_ELCG_BROKEN_REPORT.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			LEFT JOIN TB_ELCG_CHARGER_GROUP ON TB_ELCG_CHARGER.CHARGER_GROUP_ID = TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID,
			 TB_ELCG_BD, TB_ELCG_BD_GROUP, TB_MGMT_ADMIN
		<where>
			1=1
			<if test="wkUsid != null and wkUsid != ''"> 
			AND TB_ELCG_BROKEN_REPORT.WK_USID = #{wkUsid}
			</if>
			<if test="wkName != null and wkName != ''"> 
			AND TB_MGMT_ADMIN.NAME LIKE CONCAT('%', #{wkName}, '%')
			</if>
			AND TB_ELCG_BROKEN_REPORT.BD_ID = TB_ELCG_BD.BD_ID 
			AND TB_ELCG_BROKEN_REPORT.BD_GROUP_ID = TB_ELCG_BD.BD_GROUP_ID 
			AND TB_ELCG_BD.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID 
			AND TB_ELCG_BROKEN_REPORT.WK_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and fromDate != ''"> 
	 		AND DATE_FORMAT(TB_ELCG_BROKEN_REPORT.RC_DT, '%Y%m%d') &gt;= #{fromDate}
	  		</if>
			<if test="toDate != null and toDate != ''"> 
	  		AND DATE_FORMAT(TB_ELCG_BROKEN_REPORT.RC_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
		</where>
		) A
	</select>

	<select id="getInstallerList" parameterType="map" resultType="map">
		SELECT
		TB_ELCG_STATION_APPLICATION.RC_DT,
		TB_ELCG_STATION_APPLICATION.WK_USID,
		TB_MGMT_ADMIN.NAME AS WK_NAME,
		'802101' AS WK_TYPE, 
		TB_ELCG_BD_GROUP.NAME AS BD_GROUP_NAME,
		TB_ELCG_STATION_APPLICATION.BD_ID,
		TB_ELCG_BD.NAME AS BD_NAME,
		TB_ELCG_STATION_APPLICATION.STATUS,
		TB_ELCG_STATION_APPLICATION.WK_DT,
		'' AS CHARGER_ID,
		'' AS MGMT_NO,
		'' AS CHARGER_GROUP_ID,
		'' AS CHARGER_GROUP_NAME,
		'' AS EXTRA_PAY
		FROM TB_ELCG_STATION_APPLICATION, TB_ELCG_BD, TB_ELCG_BD_GROUP, TB_MGMT_ADMIN
		<where>
			1=1
			<if test="wkUsid != null and wkUsid != ''"> 
			AND TB_ELCG_STATION_APPLICATION.WK_USID = #{wkUsid}
			</if>
			<if test="wkName != null and wkName != ''"> 
			AND TB_MGMT_ADMIN.NAME LIKE CONCAT('%', #{wkName}, '%')
			</if>
			AND TB_ELCG_STATION_APPLICATION.BD_ID = TB_ELCG_BD.BD_ID 
			AND TB_ELCG_STATION_APPLICATION.BD_GROUP_ID = TB_ELCG_BD.BD_GROUP_ID 
			AND TB_ELCG_BD.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID 
			AND TB_ELCG_STATION_APPLICATION.WK_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and fromDate != ''"> 
	 		AND DATE_FORMAT(TB_ELCG_STATION_APPLICATION.RC_DT, '%Y%m%d') &gt;= #{fromDate}
	  		</if>
			<if test="toDate != null and toDate != ''"> 
	  		AND DATE_FORMAT(TB_ELCG_STATION_APPLICATION.RC_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
		</where>
		UNION
		SELECT
			TB_ELCG_BROKEN_REPORT.RC_DT,
			TB_ELCG_BROKEN_REPORT.WK_USID,
			TB_MGMT_ADMIN.NAME AS WK_NAME,
			'802102' AS WK_TYPE, 
			TB_ELCG_BD_GROUP.NAME AS BD_GROUP_NAME,
			TB_ELCG_BROKEN_REPORT.BD_ID,
			TB_ELCG_BD.NAME AS BD_NAME,
			TB_ELCG_BROKEN_REPORT.STATUS,
			TB_ELCG_BROKEN_REPORT.WK_DT,
			TB_ELCG_BROKEN_REPORT.CHARGER_ID,
			TB_ELCG_CHARGER.MGMT_NO AS MGMT_NO,
			TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID,
			TB_ELCG_CHARGER_GROUP.NAME AS CHARGER_GROUP_NAME,
			'' AS EXTRA_PAY
		FROM TB_ELCG_BROKEN_REPORT
			LEFT JOIN TB_ELCG_CHARGER ON TB_ELCG_BROKEN_REPORT.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			LEFT JOIN TB_ELCG_CHARGER_GROUP ON TB_ELCG_CHARGER.CHARGER_GROUP_ID = TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID,
			 TB_ELCG_BD, TB_ELCG_BD_GROUP, TB_MGMT_ADMIN
		<where>
			1=1
			<if test="wkUsid != null and wkUsid != ''"> 
			AND TB_ELCG_BROKEN_REPORT.WK_USID = #{wkUsid}
			</if>
			<if test="wkName != null and wkName != ''"> 
			AND TB_MGMT_ADMIN.NAME LIKE CONCAT('%', #{wkName}, '%')
			</if>
			AND TB_ELCG_BROKEN_REPORT.BD_ID = TB_ELCG_BD.BD_ID 
			AND TB_ELCG_BROKEN_REPORT.BD_GROUP_ID = TB_ELCG_BD.BD_GROUP_ID 
			AND TB_ELCG_BD.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID 
			AND TB_ELCG_BROKEN_REPORT.WK_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and fromDate != ''"> 
	 		AND DATE_FORMAT(TB_ELCG_BROKEN_REPORT.RC_DT, '%Y%m%d') &gt;= #{fromDate}
	  		</if>
			<if test="toDate != null and toDate != ''"> 
	  		AND DATE_FORMAT(TB_ELCG_BROKEN_REPORT.RC_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
		</where>
		ORDER BY RC_DT DESC
    	LIMIT #{startRow}, #{rowPerPage}
	</select>
	
	<select id="installerChargerGroupCount" parameterType="map" resultType="int">
		SELECT COUNT(*) FROM
		(
		SELECT
			TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID
		FROM
			TB_ELCG_CHARGER_GROUP, TB_ELCG_CHARGER
		<where>
			1=1
			<if test="wkUsid != null and wkUsid != ''">
			AND TB_ELCG_CHARGER.FST_RG_USID = #{wkUsid}
			</if>
			<if test="bdId != null">
			AND TB_ELCG_CHARGER_GROUP.BD_ID = #{bdId}
			</if>
			AND TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID = TB_ELCG_CHARGER.CHARGER_GROUP_ID
		</where>
		GROUP BY TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID
		) A
	</select>
	<select id="installerChargerCount" parameterType="map" resultType="int">
		SELECT COUNT(*) FROM (
		SELECT
			TB_ELCG_CHARGER.CHARGER_ID
		FROM
			TB_ELCG_CHARGER_GROUP, TB_ELCG_CHARGER
		<where>
			1=1
			<if test="wkUsid != null and wkUsid != ''">
			AND TB_ELCG_CHARGER.FST_RG_USID = #{wkUsid}
			</if>
			<if test="bdId != null">
			AND TB_ELCG_CHARGER_GROUP.BD_ID = #{bdId}
			</if>
			AND TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID = TB_ELCG_CHARGER.CHARGER_GROUP_ID
		</where>
		GROUP BY TB_ELCG_CHARGER.CHARGER_ID
		) A
	</select>
	
	<select id="installerChargerList" parameterType="map" resultType="map">
		SELECT
			TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID,
			TB_ELCG_CHARGER_GROUP.NAME AS CHARGER_GROUP_NAME,
			TB_ELCG_CHARGER.CHARGER_ID,
			TB_ELCG_CHARGER.MGMT_NO,
			TB_ELCG_CHARGER.NAME AS CHARGER_NAME
		FROM
			TB_ELCG_CHARGER_GROUP, TB_ELCG_CHARGER
		<where>
			1=1
			<if test="wkUsid != null and wkUsid != ''">
			AND TB_ELCG_CHARGER.FST_RG_USID = #{wkUsid}
			</if>
			<if test="bdId != null">
			AND TB_ELCG_CHARGER_GROUP.BD_ID = #{bdId}
			</if>
			AND TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID = TB_ELCG_CHARGER.CHARGER_GROUP_ID
		</where>
	</select>
	
	
	<!-- 건물주 이력 - 신청/신고 이력 -->
	<select id="getLandlordCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			VI_ELCG_CUST_CENTER, TB_MGMT_ADMIN
		<where>
			1=1
			<if test="rcUsid != null and rcUsid != ''"> 
	 			AND VI_ELCG_CUST_CENTER.RC_USID = #{rcUsid}
	  		</if>
				AND VI_ELCG_CUST_CENTER.RC_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and fromDate != ''"> 
	 			AND DATE_FORMAT(VI_ELCG_CUST_CENTER.RC_DT, '%Y%m%d') &gt;= #{fromDate}
	  		</if>
			<if test="toDate != null and toDate != ''"> 
	  			AND DATE_FORMAT(VI_ELCG_CUST_CENTER.RC_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
		</where>
	</select>

	<select id="getLandlordList" parameterType="map" resultType="map">
		SELECT
			VI_ELCG_CUST_CENTER.RC_DT,
			VI_ELCG_CUST_CENTER.RC_USID,
			TB_MGMT_ADMIN.NAME AS RC_NAME,
			VI_ELCG_CUST_CENTER.STATUS,
			VI_ELCG_CUST_CENTER.BODY,
			VI_ELCG_CUST_CENTER.CHAN
		FROM
			VI_ELCG_CUST_CENTER, TB_MGMT_ADMIN
		<where>
			1=1
			<if test="rcUsid != null and rcUsid != ''"> 
	 			AND VI_ELCG_CUST_CENTER.RC_USID = #{rcUsid}
	  		</if>
				AND VI_ELCG_CUST_CENTER.RC_USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and fromDate != ''"> 
	 			AND DATE_FORMAT(VI_ELCG_CUST_CENTER.RC_DT, '%Y%m%d') &gt;= #{fromDate}
	  		</if>
			<if test="toDate != null and toDate != ''"> 
	  			AND DATE_FORMAT(VI_ELCG_CUST_CENTER.RC_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
		</where>
		ORDER BY VI_ELCG_CUST_CENTER.RC_DT DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>

	<!-- 건물주/설치자 PUSH 발신 이력 -->
	<select id="getLandlordPushMsgCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_PUSH_MSG, TB_MGMT_ADMIN
		<where>
			TB_HIST_PUSH_MSG.USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_PUSH_MSG.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_PUSH_MSG.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="wkUsid != null"> 
				AND TB_HIST_PUSH_MSG.USID = #{wkUsid}
			</if>
		</where>
	</select>

	<!-- 건물주/설치자 PUSH 발신 이력 -->
	<select id="getLandlordPushMsgList" parameterType="map" resultType="map">
		SELECT
			TB_HIST_PUSH_MSG.SN_ID,
			TB_HIST_PUSH_MSG.FST_RG_DT,
			TB_HIST_PUSH_MSG.CUST_TYPE,
			TB_HIST_PUSH_MSG.CUST_NAME,
			TB_HIST_PUSH_MSG.OS,
			TB_HIST_PUSH_MSG.MOBILE,
			TB_HIST_PUSH_MSG.CATEGORY,
			TB_HIST_PUSH_MSG.TITLE,
			TB_HIST_PUSH_MSG.MSG,
			TB_HIST_PUSH_MSG.RESULT_CODE,
			TB_HIST_PUSH_MSG.USID, TB_MGMT_ADMIN.NAME
		FROM
			TB_HIST_PUSH_MSG, TB_MGMT_ADMIN
		<where>
			TB_HIST_PUSH_MSG.USID = TB_MGMT_ADMIN.ADMIN_ID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_PUSH_MSG.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_PUSH_MSG.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="wkUsid != null"> 
				AND TB_HIST_PUSH_MSG.USID = #{wkUsid}
			</if>
		</where>
		ORDER BY TB_HIST_PUSH_MSG.SN_ID DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>
	
	<!-- 한전 연동 이력 조회 -->
	<select id="getLogKepcoCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_STAT_KEPCO_PERIOD
		<where>
			DATE_FORMAT(TRANS_DT, '%Y-%m-%d') = #{historyDate}
		</where>
	</select>

	<!-- 한전 연동 이력 조회 -->
	<select id="getLogKepcoList" parameterType="map" resultType="map">
		SELECT
			TRANS_DT, START_YMD, END_YMD, METER_YMD,
			PERIOD_DAY, BD_GROUP_NAME, BD_NAME, CHARGE_AMT
		FROM
			TB_STAT_KEPCO_PERIOD
		<where>
			DATE_FORMAT(TRANS_DT, '%Y%m%d') = #{historyDate}
		</where>
		ORDER BY TRANS_DT DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>

	<!-- ThingPlug 연동 이력 조회 -->
	<select id="getLogThingPlugCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_CHARGER_IF, TB_ELCG_CHARGER
		<where>
			TB_HIST_CHARGER_IF.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_CHARGER_IF.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_CHARGER_IF.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="mgmtNo != null"> 
				AND TB_ELCG_CHARGER.MGMT_NO = #{mgmtNo}
			</if>
		</where>
	</select>

	<!-- ThingPlug 연동 이력 조회 -->
	<select id="getLogThingPlugList" parameterType="map" resultType="map">
		SELECT
			TB_HIST_CHARGER_IF.SN_ID, TB_HIST_CHARGER_IF.FST_RG_DT,
			TB_ELCG_CHARGER.MGMT_NO,
			TRANS_TYPE, CMD, MSG
		FROM
			TB_HIST_CHARGER_IF, TB_ELCG_CHARGER
		<where>
			TB_HIST_CHARGER_IF.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_CHARGER_IF.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_CHARGER_IF.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="mgmtNo != null"> 
				AND TB_ELCG_CHARGER.MGMT_NO = #{mgmtNo}
			</if>
		</where>
		ORDER BY TB_HIST_CHARGER_IF.SN_ID DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>

	<!-- GCM/APNS 연동 이력 조회 -->
	<select id="getLogGcmApnsCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_PUSH_MSG
		<where>
			1=1
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="os != null"> 
				AND OS = #{os}
			</if>
			<if test="custType != null"> 
				AND CUST_TYPE = #{custType}
			</if>
			<if test="usid != null"> 
				AND USID = #{usid}
			</if>
		</where>
	</select>

	<!-- GCM/APNS 연동 이력 조회 -->
	<select id="getLogGcmApnsList" parameterType="map" resultType="map">
		SELECT
			SN_ID, FST_RG_DT, CUST_TYPE, USID, CUST_NAME,
			OS, MOBILE, CATEGORY, TITLE, MSG, RESULT_CODE
		FROM
			TB_HIST_PUSH_MSG
		<where>
			1=1
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="os != null"> 
				AND OS = #{os}
			</if>
			<if test="custType != null"> 
				AND CUST_TYPE = #{custType}
			</if>
			<if test="usid != null"> 
				AND USID = #{usid}
			</if>
		</where>
		ORDER BY FST_RG_DT DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>

	<!-- 후불 결재사 연동 이력 조회 -->
	<select id="getLogPaymentCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_PAYMENT, TB_CUST_MEMBER
		<where>
			TB_HIST_PAYMENT.USID = TB_CUST_MEMBER.USID
			<if test="historyDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_PAYMENT.FST_RG_DT, '%Y%m') = #{historyDate}
	  		</if>
			<if test="usid != null"> 
				AND TB_HIST_PAYMENT.USID = #{usid}
			</if>
		</where>
	</select>

	<!-- 후불 결재사 연동 이력 조회 -->
	<select id="getLogPaymentList" parameterType="map" resultType="map">
		SELECT
			TB_HIST_PAYMENT.SN_ID, TB_HIST_PAYMENT.FST_RG_DT, TB_HIST_PAYMENT.PAYMENT_FEE,
			TB_CUST_MEMBER.SUBS_ID, TB_CUST_MEMBER.NAME
		FROM
			TB_HIST_PAYMENT, TB_CUST_MEMBER
		<where>
			TB_HIST_PAYMENT.USID = TB_CUST_MEMBER.USID
			<if test="historyDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_PAYMENT.FST_RG_DT, '%Y%m') = #{historyDate}
	  		</if>
			<if test="usid != null"> 
				AND TB_HIST_PAYMENT.USID = #{usid}
			</if>
		</where>
		ORDER BY TB_HIST_PAYMENT.FST_RG_DT DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>

	<!-- 건물주/건물명 목록 -->
	<select id="getAdminLandlordList" parameterType="map" resultType="map">
		SELECT
			TB_MGMT_ADMIN.ADMIN_ID AS ADMIN_ID, TB_MGMT_ADMIN.NAME AS ADMIN_NAME,
			TB_ELCG_BD_GROUP.BD_GROUP_ID AS BD_GROUP_ID, TB_ELCG_BD_GROUP.NAME AS BD_GROUP_NAME
		FROM
			TB_ELCG_BD, TB_ELCG_BD_GROUP, TB_MGMT_ADMIN
		<where>
			TB_ELCG_BD.ADMIN_ID = TB_MGMT_ADMIN.ADMIN_ID
			AND TB_ELCG_BD.BD_GROUP_ID = TB_ELCG_BD_GROUP.BD_GROUP_ID
			<if test="adminName != null"> 
	 			AND TB_MGMT_ADMIN.NAME = #{adminName}
	  		</if>
		</where>
		ORDER BY TB_MGMT_ADMIN.NAME ASC
	</select>

	<!-- 충전 이력 조회 - 일별 -->
	<select id="getChargeDayCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_CHARGE, TB_ELCG_CHARGER
		<where>
			TB_HIST_CHARGE.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			<if test="fromDate != null and fromDate != '' and fromDate !='0'"> 
 			AND DATE_FORMAT(START_DT, '%Y%m%d') &gt;= #{fromDate}
	 		</if>
			<if test="toDate != null and toDate != '' and toDate !='0'"> 
  			AND DATE_FORMAT(START_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND USID = #{usid}
			</if>
		</where>
	</select>
	<!-- 충전 이력 조회 - 일별 -->
	<select id="getChargeDayList" parameterType="map" resultType="map">
		SELECT
			CUST_NAME, TB_ELCG_CHARGER.MGMT_NO,
			START_DT, END_DT,
			CERT_TYPE, CERT_CARD_NO,
			CHARGE_AMT, CHARGE_FEE
		FROM
			TB_HIST_CHARGE, TB_ELCG_CHARGER
		<where>
			TB_HIST_CHARGE.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			<if test="fromDate != null and fromDate != ''"> 
 			AND DATE_FORMAT(START_DT, '%Y%m%d') &gt;= #{fromDate}
	 		</if>
			<if test="toDate != null and toDate != ''"> 
  			AND DATE_FORMAT(START_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND USID = #{usid}
			</if>
		</where>
		ORDER BY START_DT DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>
	<!-- 충전 이력 조회 - 월별 -->
	<select id="getChargeMonthCount" parameterType="map" resultType="int">
		SELECT COUNT(*) FROM (
		SELECT
			DATE_FORMAT(START_DT, '%Y%m') AS START_DT,
			USID, CUST_NAME,
			SUM(CHARGE_AMT) AS CHARGE_AMT,
			SUM(CHARGE_TIME) AS CHARGE_TIME,
			SUM(CHARGE_FEE) AS CHARGE_FEE,
			COUNT(*) CHARGE_CNT
		FROM
			TB_HIST_CHARGE
		<where>
			1=1
			<if test="fromDate != null and fromDate != '' and fromDate !='0'"> 
 			AND DATE_FORMAT(START_DT, '%Y%m') &gt;= #{fromDate}
	 		</if>
			<if test="toDate != null and toDate != '' and toDate !='0'"> 
  			AND DATE_FORMAT(START_DT, '%Y%m') &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND USID = #{usid}
			</if>
		</where>
		GROUP BY DATE_FORMAT(START_DT, '%Y%m'), USID, CUST_NAME DESC
		) A
	</select>
	<!-- 충전 이력 조회 - 월별 -->
	<select id="getChargeMonthList" parameterType="map" resultType="map">
		SELECT
			DATE_FORMAT(START_DT, '%Y%m') AS START_DT,
			USID, CUST_NAME,
			SUM(CHARGE_AMT) AS CHARGE_AMT,
			SUM(CHARGE_TIME) AS CHARGE_TIME,
			SUM(CHARGE_FEE) AS CHARGE_FEE,
			COUNT(*) CHARGE_CNT
		FROM
			TB_HIST_CHARGE
		<where>
			1=1
			<if test="fromDate != null and fromDate != '' and fromDate !='0'"> 
 			AND DATE_FORMAT(START_DT, '%Y%m') &gt;= #{fromDate}
	 		</if>
			<if test="toDate != null and toDate != '' and toDate !='0'"> 
  			AND DATE_FORMAT(START_DT, '%Y%m') &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
			AND USID = #{usid}
			</if>
		</where>
		GROUP BY DATE_FORMAT(START_DT, '%Y%m'), USID, CUST_NAME DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>
	
	<!-- 인증 이력 조회 - 일별 -->
	<select id="getCertCustDayCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_CUST, TB_CUST_MEMBER, TB_ELCG_CHARGER
		<where>
			TB_HIST_CUST.USID = TB_CUST_MEMBER.USID
			AND TB_HIST_CUST.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_CUST.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_CUST.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND TB_HIST_CUST.USID = #{usid}
			</if>
		</where>
	</select>
	<!-- 인증 이력 조회 - 일별 -->
	<select id="getCertCustDayList" parameterType="map" resultType="map">
		SELECT
			TB_HIST_CUST.FST_RG_DT, TB_CUST_MEMBER.NAME, TB_ELCG_CHARGER.MGMT_NO,
			TB_HIST_CUST.ACCESS_DEVICE, TB_HIST_CUST.RESULT_CODE, TB_HIST_CUST.CERT_CARD_NO
		FROM
			TB_HIST_CUST, TB_CUST_MEMBER, TB_ELCG_CHARGER
		<where>
			TB_HIST_CUST.USID = TB_CUST_MEMBER.USID
			AND TB_HIST_CUST.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			<if test="fromDate != null and toDate != null"> 
	 			AND DATE_FORMAT(TB_HIST_CUST.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  			AND DATE_FORMAT(TB_HIST_CUST.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND TB_HIST_CUST.USID = #{usid}
			</if>
		</where>
		ORDER BY TB_HIST_CUST.FST_RG_DT DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>
	<!-- 인증 이력 조회 - 월별 -->
	<select id="getCertCustMonthCount" parameterType="map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_STAT_CUST_CERTMONTH
		<where>
			<if test="fromDate != null and toDate != null"> 
	 			AND CERT_YM &gt;= #{fromDate}
	  			AND CERT_YM &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND USID = #{usid}
			</if>
		</where>
	</select>
	<!-- 인증 이력 조회 - 월별 -->
	<select id="getCertCustMonthList" parameterType="map" resultType="map">
		SELECT
			CERT_YM, USID, CUST_NAME, USE_CARD_CNT, USE_MOBILE_CNT, CERT_CNT, CERT_SUCC_CNT, CERT_FAIL_CNT
		FROM
			TB_STAT_CUST_CERTMONTH
		<where>
			<if test="fromDate != null and toDate != null"> 
	 			AND CERT_YM &gt;= #{fromDate}
	  			AND CERT_YM &lt;= #{toDate}
	  		</if>
			<if test="usid != null"> 
				AND USID = #{usid}
			</if>
		</where>
		ORDER BY CERT_YM DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>
	<!-- 실시간 이벤트 -->
	<select id="getHistChargeIfCount" parameterType="java.util.Map" resultType="int">
		SELECT
			COUNT(*)
		FROM
			TB_HIST_CHARGER_IF, TB_ELCG_CHARGER, TB_ELCG_CHARGER_GROUP, TB_ELCG_BD
		<where>
			1=1
			<if test="adminId != null and adminId != ''">
			AND TB_ELCG_BD.ADMIN_ID = #{adminId}
			</if>
			<if test="wkUsid != null and wkUsid != ''">
			AND TB_ELCG_CHARGER.FST_RG_USID = #{wkUsid}
			</if>
			AND
				TB_HIST_CHARGER_IF.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			AND
				TB_ELCG_CHARGER.CHARGER_GROUP_ID = TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID
			AND
				TB_ELCG_CHARGER_GROUP.BD_ID = TB_ELCG_BD.BD_ID
			<if test="fromDate != null and fromDate != ''"> 
	 			AND DATE_FORMAT(TB_HIST_CHARGER_IF.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  		</if>
			<if test="toDate != null and toDate != ''"> 
	  			AND DATE_FORMAT(TB_HIST_CHARGER_IF.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="mgmtNo != null and mgmtNo != '' and mgmtNo !=''">
				AND TB_ELCG_CHARGER.MGMT_NO = #{mgmtNo}
			</if>
			<if test="_parameter.containsKey('cmd') and cmd != null and _parameter.get('cmd').length > 0">
			    AND TB_HIST_CHARGER_IF.CMD IN
			    <foreach item="item" index="index" collection="cmd" open="(" separator="," close=")">
			        #{item}
			    </foreach>
			</if>
			AND CMD LIKE 'C0%'
		</where>
	</select>
	<select id="getHistChargeIfList" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT
			TB_HIST_CHARGER_IF.SN_ID,
			TB_HIST_CHARGER_IF.FST_RG_DT,
			TB_HIST_CHARGER_IF.CHARGER_ID, 
			TB_ELCG_CHARGER.MGMT_NO, 
			TB_HIST_CHARGER_IF.CMD,
			TB_HIST_CHARGER_IF.MSG
		FROM
			TB_HIST_CHARGER_IF, TB_ELCG_CHARGER, TB_ELCG_CHARGER_GROUP, TB_ELCG_BD
		<where>
			1=1
			<if test="adminId != null and adminId != ''">
			AND TB_ELCG_BD.ADMIN_ID = #{adminId}
			</if>
			<if test="wkUsid != null and wkUsid != ''">
			AND TB_ELCG_CHARGER.FST_RG_USID = #{wkUsid}
			</if>
			AND
				TB_HIST_CHARGER_IF.CHARGER_ID = TB_ELCG_CHARGER.CHARGER_ID
			AND
				TB_ELCG_CHARGER.CHARGER_GROUP_ID = TB_ELCG_CHARGER_GROUP.CHARGER_GROUP_ID
			AND
				TB_ELCG_CHARGER_GROUP.BD_ID = TB_ELCG_BD.BD_ID
			<if test="fromDate != null and fromDate != ''"> 
	 			AND DATE_FORMAT(TB_HIST_CHARGER_IF.FST_RG_DT, '%Y%m%d') &gt;= #{fromDate}
	  		</if>
			<if test="toDate != null and toDate != ''"> 
	  			AND DATE_FORMAT(TB_HIST_CHARGER_IF.FST_RG_DT, '%Y%m%d') &lt;= #{toDate}
	  		</if>
			<if test="mgmtNo != null and mgmtNo != '' and mgmtNo !=''">
				AND TB_ELCG_CHARGER.MGMT_NO = #{mgmtNo}
			</if>
			<if test="_parameter.containsKey('cmd') and cmd != null and _parameter.get('cmd').length > 0">
			    AND TB_HIST_CHARGER_IF.CMD IN
			    <foreach item="item" index="index" collection="cmd" open="(" separator="," close=")">
			        #{item}
			    </foreach>
			</if>
			AND CMD LIKE 'C0%'
		</where>
		ORDER BY FST_RG_DT DESC
     	LIMIT #{startRow}, #{rowPerPage}
	</select>
	
</mapper>
