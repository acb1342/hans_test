<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hans.sses.member.dao.EquipmentDao">

	<select id="getCount" parameterType="java.util.Map" resultType="int">
		SELECT  COUNT(*)
		FROM TBL_EQUIPMENT_INFO
		<where>
			<if test="param.searchType != null">
				<choose>
					<when test="param.searchType == 'name' ">
						name LIKE CONCAT('%', #{param.searchValue}, '%')
					</when>
					<otherwise>

					</otherwise>
				</choose>
			</if>
		</where>
	</select>

	<select id="getList" parameterType="java.util.Map" resultType="com.hans.sses.member.model.Equipment">
		SELECT macaddress, name, manufacturer, make_date, watt, hardwareinfo, request_ip as request_ip, charge, reg_date, mod_date
		FROM TBL_EQUIPMENT_INFO
		<where>
			<if test="param.searchType != null">
				<choose>
					<when test="param.searchType == 'name' ">
						name LIKE CONCAT('%', #{param.searchValue}, '%')
					</when>
					<otherwise>

					</otherwise>
				</choose>
			</if>
		</where>
		ORDER BY reg_date DESC
		LIMIT #{param.startRow}, #{param.rowPerPage}
	</select>

	<insert id="equipmentCreate" parameterType="com.hans.sses.member.model.Equipment">
		INSERT INTO TBL_EQUIPMENT_INFO (macaddress, name, manufacturer, make_date, watt, hardwareinfo, request_ip, charge, reg_date )
		VALUES (#{equipment.macaddress}, #{equipment.name}, #{equipment.manufacturer}, #{equipment.make_date}, #{equipment.watt}, #{equipment.hardwareinfo}, #{equipment.request_ip}, #{equipment.charge}, NOW())
	</insert>

	<select id="getDetail" parameterType="String" resultType="com.hans.sses.member.model.Equipment">
		SELECT macaddress, name, manufacturer, make_date, etc, watt, charge, reg_date, mod_date
		FROM TBL_EQUIPMENT_INFO
		<where>
			macaddress = #{macaddress}
		</where>
	</select>

	<update id="equipmentUpdate" parameterType="com.hans.sses.member.model.Equipment">
		UPDATE TBL_EQUIPMENT_INFO SET
		name = #{equipment.name},
		manufacturer = #{equipment.manufacturer},
		make_date = #{equipment.make_date},
		watt = #{equipment.watt},
		charge = #{equipment.charge},
		mod_date = NOW()
		WHERE macaddress = #{equipment.macaddress}
	</update>

	<delete id="equipmentDelete" parameterType="Integer">
		DELETE FROM TBL_EQUIPMENT_INFO WHERE macaddress = #{macaddress}
	</delete>

	<select id="getWattInfoList" resultType="Map">
		SELECT code, charge, reg_date, mod_date
		FROM TBL_WATT_INFO
		ORDER BY REG_DATE ASC
	</select>

</mapper>